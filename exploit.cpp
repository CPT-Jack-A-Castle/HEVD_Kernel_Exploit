/**
 * HackSysExtremeVulnerableDriver exploit pack consisting of all of the possible
 * exploits against that vulnerable driver. To be used in learning process of 
 * Windows Kernel Exploitation journey. 
 *
 * Intended to be run under: Windows 7 SP1 x86, English
 * 
 * Compilation:
 *		cmd> g++ -g3 -m32 -std=c++11 -Wall exploit.cpp -lntdll -o exploit.exe
 * 
 * Mariusz B. / mgeeky.
 *
**/

#include "common.h"
#include "driver.h"
#include "hevd_constants.h"


using namespace std;

int 
main(
	int argc, 
	char** argv
) {
	
	wcout << Vulnerable_Driver_Name << endl;
	wcout << L"Local Privilege Escalation exploit's pack'" << endl;
	wcout << L"Mariusz B. / mgeeky, '17" << endl << endl;
	
	Driver drv(Vulnerable_Driver_Name, Vulnerable_Driver_Module_Name, &g_ioctlCodeNames);
	if(!drv) {
		wcerr << L"[!] Could not open the driver.\n\tError: " << drv.getErrorString() << endl;
		return 1;
	}
	
	wcout << L"[+] Opened " << Vulnerable_Driver_Name << " driver's handle." << endl;

	drv.SendIOCTL(HACKSYS_EVD_IOCTL_STACK_OVERFLOW, nullptr, 100);
	
	return 0;
}
