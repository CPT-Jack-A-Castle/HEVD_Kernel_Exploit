#pragma once

#include "common.h"
#include "IExploit.h"
#include "hevd_constants.h"

class ExploitStackOverflow : public IExploit {
	static constexpr wchar_t *Exploit_Name = L"Stack Overflow";
	static constexpr DWORD Ioctl_Code = HACKSYS_EVD_IOCTL_STACK_OVERFLOW;
	
public:
	ExploitStackOverflow(Driver& driver) : IExploit(driver) {}
	virtual ~ExploitStackOverflow() {}
	
	virtual const wchar_t* getName() const { 
		return ExploitStackOverflow::Exploit_Name;
	};
	
	virtual DWORD getIoctlCode() const {
		return ExploitStackOverflow::Ioctl_Code;
	}
	
	virtual bool exploit();
};
