#pragma once

#include "common.h"
#include "IExploit.h"
#include "HevdConstants.h"

class ExploitUseAfterFree : public IExploit {
	static constexpr wchar_t *Exploit_Name 	= L"Use After Free";
	static constexpr DWORD Ioctl_Code_Allocate	= HACKSYS_EVD_IOCTL_ALLOCATE_UAF_OBJECT;
	static constexpr DWORD Ioctl_Code_Use 		= HACKSYS_EVD_IOCTL_USE_UAF_OBJECT;
	static constexpr DWORD Ioctl_Code_Free 		= HACKSYS_EVD_IOCTL_FREE_UAF_OBJECT;
	
public:
	ExploitUseAfterFree(Driver& driver) : IExploit(driver) {}
	virtual ~ExploitUseAfterFree() {	}
	
	virtual const wchar_t* getName() const { 
		return ExploitUseAfterFree::Exploit_Name;
	};
	
	virtual DWORD getIoctlCode() const {
		return ExploitUseAfterFree::Ioctl_Code_Allocate;
	}
	
	virtual bool exploit();

};
